# barrins-data

Barrin's Data is a project to analyze and predict Duel Commander (MTGDC) format:
- `mtgdc_scrapper` extracts data from [MTGTOP8](https://mtgtop8.com/index);
- `mtgdc_decklists` stores tournaments in the form of JSON files;
- `mtgdc_banlist` keeps track of what's legal and what's not;
- `mtgdc_clustering` reduces data to be able to analyze it easily;
- `mtgdc_aggregator` reduces a set of lists to a most probable list;

## mtgdc_scrapper
Module that scraps MTGTOP8 to retreive MTGDC tournaments. Thoses files are stored in `mtgdc_decklists`.

## mtgdc_decklists
A repository to store every tournament stored on MTGTOP8.

### What is MTGTOP8?
MTGTOP8 is a website that stores tournaments on every MTG format. This works through a declarative statement made by any user to have their tournament displayed. This is maintained outside of any `Barrin's Codex` projects.

### How is the data stored?
The `decklists` folder contains a set of data extracted from MTGTOP8 as `<tournament_id>?json`. To go to the original source, the `<tournament_id>` needs to be put in the following web adress: `https://mtgtop8.com/event?e=<id_tournoi>`.

Inside every `json` file is a set of data:
```json
{
    "format": "Duel Commander",
    "id": "2696",
    "name": "EDH (Saint-Nazaire)",
    "place": "",
    "players": "65 players",
    "date": "01/04/12",
    "decks": [
        {
            "deck_id": "217420",
            "rank": "1",
            "player": "Nicolas \"thorgal666\" Fran√ßois",
            "commander": [ /* commanders */ ],
            "decklist": [ /* cards */ ]
        }
    ]
}
```
The deck view is available here:`https://mtgtop8.com/event?e=<id_tournoi>&d=<id_deck>`


## mtgdc_banlist
A new service to help developpers to keep an up-to-date MTGDC data.

### The Solution to keep the project alive
* Each banlist is stored as `JSON` file of condensed data from official source (in `mtgdc_banlist/banlists` folder)
* Static files generated by running a script (`python mtgdc_banlist`) which uses banlists files to create the main part of the document, and adds html header/footer from static files (`static/banlist_html_header.html` and `static/banlist_html_footer.html`)

### Storing banlists and adding them to the project
#### File Structure
File name must be `%Y-%m-%d.json` format with the following template:
```json
[
    {
        "date": "2015-01-31",
        "special": "",
        "newly_banned_as_commander": [],
        "newly_unbanned_as_commander": [],
        "newly_banned_in_deck": [],
        "newly_unbanned_in_deck": [],
        "explanations": {}
    }
]
```

#### How to add the file and update the project
1. Put banlist file `%Y-%m-%d.json` file into `./banlists`
1. Re-run python `python mtgdc_banlist` with options `--compile-html`, `--compile-json` or `--compile-both`

*Works similar to edit/delete a banlist.*

## mtgdc_clustering

## mtgdc_aggregator
